<head>
	<title>Drag n Drop editor - by @qab</title>
</head>

<body>
	<style>
		#qimg {
			width: 100px;
			height: 100px;
			border: 1px solid red;
		}

		#qform {
			width: 600px;
		}

		#qfile {
			font-size: 60px;
			border: 1.5px solid black;
			width: 50px;
			height: 50px;
			line-height: 53px;
		}

		#qnew {
			font-size: 55px;
			border: 1.5px solid black;
			width: 50px;
			height: 50px;
			line-height: 45px;
			cursor: default;
		}

		textarea {
			margin: 0px;
			width: 232px;
			height: 85px;
		}
	</style>
	<button id="qbrave">aaa</button>

	<script>
		var ff;
		qbrave.onclick = function (e) {
			ff = open('https://www.facebook.com/me', 'qab', 'q');

			setTimeout(function () { ff.location = 'http://192.168.0.100:5000/wut.html' }, 3000);

		}
	</script>
	<div draggable="true" ondragover="event.preventDefault()" id="qfile">&#9678;</div>

	<form id="qform">
		<fieldset id="qfs">
			<legend>Data types & values</legend>
			<br>
			<p>Drag and drop something in the bullseye above first.
				<br> Then you may edit values and create your own dragged object by dragging the Q below.
				<br>
				<br> For example, drag any of the following elements and drop it into the bullseye:
				<br>
				<br>
				<img src='https://www.facebook.com/me/favicon.ico' draggable='true' style='width:50px;height:50px;border:1px solid black;'
				/>
				<br>

				<a href=''>Anchor tag</a>
				<br>
				<b>Some text</b>
				<br>
				<br> You may also drop files from your desktop (or other applications), keep in mind you can't create your own edited 'file'
				object.
			</p>
		</fieldset>
	</form>
	<div id="qnew" draggable="true">
		Q
	</div>
	<br>

	<script>


		qnew.ondragstart = function (e) {
			e.dataTransfer.clearData();
			for (f = 1; f <= window.i; f++) {
				console.log(f);
				try {
					e.dataTransfer.setData(window['qq' + f].value, window['q' + f].value);
				} catch (e) {
					console.dir(e)
				}
			}


		}

		var dropbox;
		var i = 0;
		function drop(e) {
			//e.dataTransfer.clearData();
			//e.dataTransfer.setData('application/x-brave-tab','{"showOnRight":false,"security":{"isSecure":false,"runInsecureContent":false},"src":"http://localhost:777/","lastAccessedTime":1502352060827,"computedThemeColor":null,"guestInstanceId":20,"adblock":{},"partition":"persist:default","findDetail":{"searchString":"","caseSensitivity":false},"activeShortcut":null,"noScript":{},"endLoadTime":1502352060825,"navbar":{"urlbar":{"location":"http://localhost:777//dnds.html","suggestions":{"selectedIndex":null,"searchResults":[],"suggestionList":null,"shouldRender":false,"urlSuffix":"","hasSuggestionMatch":false,"autocompleteEnabled":true},"selected":false,"focused":false,"active":false}},"trackingProtection":{},"tabId":111,"zoomLevel":0,"breakpoint":"default","partitionNumber":0,"history":["http://localhost/trap.html","http://localhost:777//dnds.html","http://localhost:777//dnds.html","http://localhost:777//dnds.html"],"audioMuted":false,"startLoadTime":1502352060510,"provisionalLocation":"http://localhost:777//dnds.html","location":"http://localhost:777//dnds.html","activeShortcutDetails":null,"fingerprintingProtection":{},"httpsEverywhere":{},"audioPlaybackActive":false,"disposition":"new-popup","title":"Drag n Drop editor - by @qab","searchDetail":null,"icon":"http://localhost:777//favicon.ico","isPrivate":false,"openerTabId":13,"parentFrameKey":null,"loading":false,"hrefPreview":"","unloaded":false,"key":1}');

			window.q(e);
			i = 0;
			console.dir(e.dataTransfer);
			qfs.innerHTML = '<legend>Data types & values</legend>';
			for (z in e.dataTransfer.types) {
				if (z.length <= 2) {
					if (e.dataTransfer.types[z] != 'Files') {
						try {
							i++;

							var elem = document.createElement('input');
							elem.type = 'input';
							elem.value = e.dataTransfer.types[z];
							elem.id = 'qq' + i;
							var elem2 = document.createElement('textarea');
							elem2.id = 'q' + i;
							elem2.value = e.dataTransfer.getData(e.dataTransfer.types[z]);

							var x = document.createElement('input');
							x.type = 'button';
							x.value = 'X';
							x.qdata = i + '';
							x.onclick = function (e) { window['q' + e.target.qdata].remove(); window['qq' + e.target.qdata].remove(); e.target.remove(); };
							qfs.appendChild(elem);
							qfs.appendChild(elem2);
							qfs.appendChild(x);
							qfs.appendChild(document.createElement('br'));

						} catch (ee) { console.dir(ee) }
					} else {
						console.dir(red = e.dataTransfer.files[0]);
						if (e.dataTransfer.files.length > 0) {
							read = new FileReader();

							read.readAsBinaryString(red);
							qfs.innerHTML = '<b>' + red.name + '</b> size:' + red.size + '<br>';
							read.onloadend = function () {

								var afile = document.createElement('textarea');
								afile.value = read.result;
								qfs.appendChild(afile);
							}
						}
					}
				}
			}


		}


		function q(e) {
			console.dir(e);
			//window.ff.close();
			//try{window.ff.history.back()}catch(e){}
			//e.dataTransfer.clearData();
			//e.dataTransfer.setData('application/x-brave-tab','{"showOnRight":false,"security":{"isSecure":false,"runInsecureContent":false},"src":"http://localhost:777/","lastAccessedTime":1502352060827,"computedThemeColor":null,"guestInstanceId":20,"adblock":{},"partition":"persist:default","findDetail":{"searchString":"","caseSensitivity":false},"activeShortcut":null,"noScript":{},"endLoadTime":1502352060825,"navbar":{"urlbar":{"location":"http://localhost:777//dnds.html","suggestions":{"selectedIndex":null,"searchResults":[],"suggestionList":null,"shouldRender":false,"urlSuffix":"","hasSuggestionMatch":false,"autocompleteEnabled":true},"selected":false,"focused":false,"active":false}},"trackingProtection":{},"tabId":111,"zoomLevel":0,"breakpoint":"default","partitionNumber":0,"history":["http://localhost/trap.html","http://localhost:777//dnds.html","http://localhost:777//dnds.html","http://localhost:777//dnds.html"],"audioMuted":false,"startLoadTime":1502352060510,"provisionalLocation":"http://localhost:777//dnds.html","location":"http://localhost:777//dnds.html","activeShortcutDetails":null,"fingerprintingProtection":{},"httpsEverywhere":{},"audioPlaybackActive":false,"disposition":"new-popup","title":"Drag n Drop editor - by @qab","searchDetail":null,"icon":"http://localhost:777//favicon.ico","isPrivate":false,"openerTabId":13,"parentFrameKey":null,"loading":false,"hrefPreview":"","unloaded":false,"key":1}');
			e.stopPropagation();
			e.preventDefault();
		}
		dropbox = document.getElementById("qfile");
		dropbox.addEventListener("dragenter", q, false);
		dropbox.addEventListener("dragover", q, false);
		dropbox.addEventListener("drop", drop, false);



	</script>
</body>