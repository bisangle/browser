<button onclick="test()">clickme</button>
<script>
function test()
{
  w = open('https://www.amazon.cn/')
}
called = 0
function runner()
{
  try{
    if (!w.document) {
      if (!called) {
        w.location = 'view-source:http://localhost:8000/'
        called++
      }
      if (called < 5) {
        setTimeout(function(){w.location = 'http://wwww.google.cn'}, 1000)
        called++
      }
    }
  }catch(e){}
}
t = setInterval(runner, 1000)
</script>