# Security: Bypass of same-origin policy via range requests in PDF plugin

> Reported by rob@robwu.nl, Oct 7 2016

## VULNERABILITY DETAILS

The built-in PDF plugin has a scripting interface that allows same-origin pages to read the content of the PDF file.
This "same-origin" check is based on the requested URL, after following all redirects, if any. This works fine, usually. Except the checks can be bypassed by forcing range requests and redirecting in a partial response.

Steps to reproduce:

1. Download the attached files.
2. Start the Python server.
3. Visit http://localhost:8080/
4. Input the URL of a PDF file (or use the existing example, the Bitcoin paper).
5. Click on the "Show content" button.
6. The contents of the (cross-origin) PDF is output.

NOTE: The above PoC is for PDF files, but the vulnerability can be abused to read any kind of data from other servers, by constructing the response in the following way: [PDF header] [padding] [cross-origin data via redirects] [padding] [PDF trailer].

## VERSION

Chrome version: stable (53.0.2785.116) and latest (55.0.2882.0)

Link: https://bugs.chromium.org/p/chromium/issues/detail?id=653749