<!DOCTYPE html>
<form>
<input type="url" placeholder="Enter any PDF URL" id="url" style="width:80vw" value="https://bitcoin.org/bitcoin.pdf">
<input type="submit" value="Show content">
<br>
<textarea style="width:80vw;height:80vh" id="output"></textarea>
</form>
<script>
document.forms[0].onsubmit = function(e) {
    e.preventDefault();
    var url = document.getElementById('url').value;
    getContent(url, function(content) {
        document.getElementById('output').value = content;
    });
};
function getContent(url, callback) {
    var e = document.createElement('embed');
    e.type = 'application/pdf';
    e.src = '/REDIRECT/' + url;
    document.body.appendChild(e);

    window.addEventListener('message', onmessage);
    e.postMessage({type: 'selectAll'});
    e.postMessage({type: 'getSelectedText'});
    
    function onmessage(event) {
        if (event.data.type === 'getSelectedTextReply') {
            window.removeEventListener('message', onmessage);
            e.remove();
            callback(event.data.selectedText || 'No text received');
        };
    }
}
</script>
