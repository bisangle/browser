# Security: XSS in "Site blocked" (supervised user) interstitial and chrome://interstitials/supervised_user

> Reported by rob@robwu.nl, Dec 24

## VULNERABILITY DETAILS

The "Site blocked" interstitial for supervised users has multiple XSS vulnerabilities at `chrome://interstitials/supervised_user`.
The generated HTML is used in two places, and can be used as follows:

- Modify the custodian name and/or e-mail to contain a XSS payload. When the user triggers the supervised user interstitial, XSS will occur.
- Open the `chrome://interstitials/supervised_user` debug page with additional query string parameters. This can be done manually or with a Chrome extension.

The Content-Security-Policy of interstitial pages is as follows [2]:
script-src `chrome://resources` 'self' 'unsafe-eval' 'unsafe-inline';
... and because of this very liberal policy, it does not offer protection against XSS (notably 'unsafe-inline' is allowed).

The impact of this vulnerability is access to any privileged webui API that is exposed to the page, as well as the ability to navigate to any other restricted URL ( such as `chrome://quit` ).

## VERSION

Chrome Version: 63.0.3239.108 (stable), 65.0.3303.0 (canary)

## REPRODUCTION CASE

Open the following URL and observe a navigation to `chrome://quit`:
`chrome://interstitials/supervised_user?custodian=<img+src+onerror=location='chrome://quit'>`

Or achieve the same effect by loading the attached Chrome extension via "Load unpacked extension" at `chrome://extensions` (extensions are normally not allowed to navigate to `chrome://quit`).

The most realistic scenario to abuse this is through an extension: either by a malicious extension that directly calls chrome.tabs.create with the given URL (as in the attached example), or by an extension that blindly passes external URLs to a chrome.tabs.create/update function (which is not uncommon, sadly).

Link: https://bugs.chromium.org/p/chromium/issues/detail?id=797525
